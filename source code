UPLOADING:

import pandas as pd
file_path = '/content/country_wise_latest.csv' 

df = pd.read_csv(file_path)

print("Dataset shape:", df.shape)
print(df.head())


DATA CLEANING:
import pandas as pd
import numpy as np

# The DataFrame 'df' was loaded in a previous cell, so we will use it directly.
# df = pd.read_csv("your_file.csv") # Removed this line

df.drop_duplicates(inplace=True)
df.dropna(thresh=int(df.shape[1] * 0.5), inplace=True)
for col in df.columns:
    if df[col].dtype in ['int64', 'float64']:
        df[col].fillna(df[col].median(), inplace=True)
    else:
        df[col].fillna(df[col].mode()[0], inplace=True)

df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_')
for col in df.select_dtypes(include=['object']):
    df[col] = df[col].str.strip()
for col in df.select_dtypes(include=[np.number]):
    lower, upper = df[col].quantile([0.01, 0.99])
    df[col] = df[col].clip(lower, upper)

df.to_csv("cleaned_dataset.csv", index=False)

DATA EXPLORATION:


import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np 


print("Shape:", df.shape)
print(df.info())
print("\nMissing values per column:\n", df.isnull().sum())
plt.figure(figsize=(10, 6))
sns.heatmap(df.isnull(), cbar=False, cmap="viridis")
plt.title("Missing Values Heatmap")
plt.show()

numeric_cols = df.select_dtypes(include=['int64', 'float64']).columns

df[numeric_cols] = df[numeric_cols].replace([np.inf, -np.inf], np.nan)

df[numeric_cols].hist(figsize=(15, 10), bins=30)
plt.suptitle("Numeric Columns Distribution", fontsize=16)
plt.show()
if len(numeric_cols) > 1:
    plt.figure(figsize=(10, 8))
    sns.heatmap(df[numeric_cols].corr(), annot=True, fmt=".2f", cmap="coolwarm")
    plt.title("Correlation Heatmap")
    plt.show()
categorical_cols = df.select_dtypes(include=['object']).columns[:5]
for col in categorical_cols:
    plt.figure(figsize=(8, 4))
    sns.countplot(x=col, data=df, order=df[col].value_counts().index[:10])  
    plt.title(f"Count Plot: {col}")
    plt.xticks(rotation=45)
    plt.show()
